-- Cambia aqu√≠ el folio de inicio (solo debe ser un pedido)
WITH PEDIDO AS (
    SELECT DOCTO_VE_ID, FOLIO, FECHA, TIPO_DOCTO
    FROM DOCTOS_VE
    WHERE FOLIO = '000008493' AND TIPO_DOCTO = 'P'
),
REMISIONES AS (
    SELECT r.DOCTO_VE_ID, r.FOLIO, r.FECHA, r.TIPO_DOCTO, p.FOLIO AS ORIGEN
    FROM DOCTOS_VE_LIGAS l
    JOIN DOCTOS_VE r ON l.DOCTO_VE_DEST_ID = r.DOCTO_VE_ID AND r.TIPO_DOCTO = 'R'
    JOIN PEDIDO p ON l.DOCTO_VE_FTE_ID = p.DOCTO_VE_ID
),
FACTURAS AS (
    SELECT f.DOCTO_VE_ID, f.FOLIO, f.FECHA, f.TIPO_DOCTO, r.FOLIO AS ORIGEN
    FROM DOCTOS_VE_LIGAS l
    JOIN DOCTOS_VE f ON l.DOCTO_VE_DEST_ID = f.DOCTO_VE_ID AND f.TIPO_DOCTO = 'F'
    JOIN REMISIONES r ON l.DOCTO_VE_FTE_ID = r.DOCTO_VE_ID
)

SELECT 'PEDIDO' AS DOCUMENTO, FOLIO, FECHA, TIPO_DOCTO, NULL AS ORIGEN
FROM PEDIDO

UNION ALL

SELECT 'REMISION', FOLIO, FECHA, TIPO_DOCTO, ORIGEN
FROM REMISIONES

UNION ALL

SELECT 'FACTURA', FOLIO, FECHA, TIPO_DOCTO, ORIGEN
FROM FACTURAS

ORDER BY 3
